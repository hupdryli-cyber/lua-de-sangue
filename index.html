<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Lua de Sangue</title>
<style>
  body {
    margin: 0;
    padding: 0;
    background: #000;
    color: #b30000;
    font-family: "Cinzel", serif;
    text-align: center;
    background-image: url('IMAGE1.png');
    background-size: cover;
    background-attachment: fixed;
    background-blend-mode: multiply;
    animation: pulseBg 8s infinite alternate;
  }

  @keyframes pulseBg {
    0% { filter: brightness(0.6); }
    100% { filter: brightness(1); }
  }

  .centered { margin-top: 80px; }

  .blood-moon {
    width: 320px;
    height: 320px;
    border-radius: 50%;
    background: url('IMAGE3.png');
    background-size: cover;
    margin: 0 auto;
    box-shadow: 0 0 50px #b30000, 0 0 90px #4d0000 inset;
    animation: moonPulse 4s infinite ease-in-out;
  }

  @keyframes moonPulse {
    0% { transform: scale(1); box-shadow: 0 0 40px #b30000; }
    100% { transform: scale(1.04); box-shadow: 0 0 80px #ff0000; }
  }

  .phrase {
    margin-top: 40px;
    font-size: 1.6rem;
    letter-spacing: 3px;
    text-shadow: 0 0 8px #b30000;
    animation: glitch 3s infinite;
  }

  @keyframes glitch {
    0% { opacity: 1; }
    45% { opacity: 1; }
    46% { opacity: 0.6; transform: translateX(-2px); }
    47% { opacity: 1; transform: translateX(2px); }
    48% { opacity: 0.7; }
    100% { opacity: 1; transform: none; }
  }

  .buttons {
    margin-top: 60px;
    display: flex;
    flex-direction: column;
    gap: 20px;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
  }

  button {
    background: #1a0000;
    color: #b30000;
    border: 1px solid #b30000;
    padding: 12px;
    font-size: 1.2rem;
    cursor: pointer;
    transition: 0.3s;
    text-shadow: 0 0 6px #b30000;
  }

  button:hover {
    background: #b30000;
    color: #000;
    box-shadow: 0 0 15px #b30000;
  }

  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.95) url('IMAGE2.png');
    background-size: cover;
    color: #b30000;
    display: none;
    padding: 40px;
    overflow-y: auto;
    animation: fadeIn 0.5s;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .ritual-symbol {
    width: 330px;
    height: 330px;
    margin: 20px auto;
    border-radius: 50%;
    border: 3px solid #b30000;
    box-shadow: 0 0 40px #b30000;
    background-image: url('IMAGE4.png');
    background-size: cover;
    animation: rotate 20s linear infinite;
  }

  @keyframes rotate {
    from { transform: rotate(0); }
    to { transform: rotate(360deg); }
  }

  /* small responsive tweaks */
  @media (max-width:600px){ .phrase { font-size:1.1rem } .blood-moon{width:220px;height:220px} }
</style>

<!-- Define openPage early so onclick handlers work when buttons are parsed -->
<script>
function openPage(id){
  const el = document.getElementById(id);
  if(!el) return;
  // hide other overlays
  document.querySelectorAll('.overlay').forEach(o=>{ if(o!==el) o.style.display='none'; });
  el.style.display = 'block';
  // scroll top of overlay
  el.scrollTop = 0;
}
// Also provide a helper to close overlays with Escape
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape'){ document.querySelectorAll('.overlay').forEach(o=>o.style.display='none'); }});
</script>
</head>
<body>

<div class="centered">
  <div class="blood-moon" aria-hidden="true"></div>
  <div class="phrase">"Quando a lua sangra... o esquecido desperta."</div>
  <div class="phrase">"Nada permanece enterrado para sempre."</div>

  <div class="buttons">
    <button onclick="openPage('pg1')">O que é a Lua de Sangue?</button>
    <button onclick="openPage('pg2')">Quais foram as 3 Luas de Sangue?</button>
    <button onclick="openPage('pg3')">○ ○ ○ ○ ○</button>
    <button onclick="openPage('pg4')">Quando será a próxima Lua de Sangue?</button>
    <button onclick="openPage('pg5')">Como impedir a Lua de Sangue?</button>
  </div>
</div>

<!-- PAGE 1 -->
<div id="pg1" class="overlay">
  <div class="ritual-symbol" aria-hidden="true"></div>
  <h2>Um Presente e uma Dor</h2>
  <p>Uma Lua a cada era, assim "ELE" se manterá em sua prisão.</p>
  <p>Um povo cairá, e um amado ressurgirá.</p>
</div>

<!-- PAGE 2 -->
<div id="pg2" class="overlay" style="font-size:0.85rem;">
  <h1>Luas de Sangue</h1>

  <h2>Primeira Lua de Sangue — O Acordo Feito</h2>
  <p>Era Élfica: 1ª Era<br>Data: Ano 666 Calanir, dia 73, hora 03:19:47</p>
  <p><strong>Kharum-Dhal</strong><br>
  Criaturas baixas de pele acinzentada, com corcovas cheias de fluidos corrosivos e endurecedores usados na alimentação e na construção. Possuíam um espiral de pele pulsante no lugar do rosto, que servia como sensor de movimento e boca ao mesmo tempo. As espirais eram formadas por guelras carnosas usadas para respirar e triturar alimento e no centro da espiral e rosto deles tinha um pequeno orifício onde podiam atirar seus fluidos. Viviam em labirintos dobrados, moldando ao redor.<br>
  <strong>Extinção:</strong> Grandes terremotos surgiram espalhados por todo o continente; seus labirintos subterrâneos desmoronaram e eles foram todos mortos.</p>

  <h2>Segunda Lua de Sangue — A Investida</h2>
  <p>Era Élfica: 2ª Era<br>Data Élfica: Ano 4.679 Ysiriel, dia 12, hora 03:19:47</p>
  <p><strong>Nhalrîe</strong><br>
  Seres alongados com peles translúcidas, abrigando dentro do corpo uma tempestade perpétua de neve e vento. Rostos sem feições, apenas uma fenda vertical de onde escapavam murmúrios gélidos, comunicando-se com rajadas de ar. Viviam sob o gelo profundo em colônias silenciosas, onde o inverno era uma parte viva e sensível.<br>
  <strong>Extinção:</strong> Uma chuva fervente caiu o dia inteiro, derretendo todos eles.</p>

  <h2>Terceira Lua de Sangue — A Ruína de um Império</h2>
  <p>Era Élfica: 3ª Era<br>Data: Ano 5 Avalen, dia 99, hora 03:19:47</p>
  <p><strong>Orrun-Mëi</strong><br>
  Criaturas pequenas, entre 70 e 90 cm, com pele lisa e úmida, cauda curta de peixe e dedos membranosos. Tinham cabeças arredondadas com olhos grandes e pretos, capazes de enxergar bem na água turva; vocalizavam em croaks curtos e suaves. Viviam nos grandes oceanos.<br>
  <strong>Extinção:</strong> Depois de milhares de anos, todas as Tartarugas Dragão saíram de hibernação ao mesmo tempo. O único momento na história em que algo assim aconteceu.</p>
</div>

<!-- PAGE 3 -->
<div id="pg3" class="overlay">
  <div>● O Primogênito</div>
  <div>● O Inocente</div>
  <div>● O Traidor</div>
  <div>● O Sábio</div>
  <div>● O Guerreiro</div>
</div>

<!-- PAGE 4 — Substituída pelo Minigame Completo -->
<div id="pg4" class="overlay" style="overflow-y:auto; padding-bottom:80px;">

<style>
  :root{
    --bg:#0b0b0f;
    --card:#0f0f12;
    --accent:#ff3b3b;
    --accent-strong: #ff1a1a;
  }
  #pg4{ background:linear-gradient(180deg,#060608,#0b0b0f); color:#e8e8e8; }
  #pg4 .container { max-width:720px; margin:20px auto; background: linear-gradient(180deg,#0e0e10,#131218); padding:22px; border-radius:14px; box-shadow:0 12px 40px rgba(0,0,0,0.6); }
  #pg4 h2{ margin:0 0 10px 0; font-weight:700 }
  #pg4 label{ display:block; margin-top:10px; font-weight:600; font-size:14px }
  #pg4 select,#pg4 input{ width:100%; padding:8px 10px; margin-top:6px; border-radius:8px; border:none; background:var(--card); color:#fff; box-sizing:border-box }
  #pg4 button{ width:100%; padding:12px; margin-top:14px; background:var(--accent-strong); color:#fff; border:none; border-radius:10px; cursor:pointer; font-weight:700 }
  #pg4 #resultado{ margin-top:16px; padding:14px; border-radius:10px; background:#081015; text-align:center; min-height:72px; position:relative; overflow:visible }
  #pg4 .msg { font-size:16px }
  #pg4 .err { color:#ff9b9b }
  #pg4 .ok { color:#bfe5bf }

  .special-text {
    display:inline-block;
    color: var(--accent);
    font-weight: 900;
    font-size: 22px;
    padding: 8px 14px;
    border-radius: 8px;
    text-shadow: 0 0 8px rgba(255,59,59,0.5);
    transform-origin:center;
  }

  @keyframes intenseGlow {
    0% { text-shadow: 0 0 6px rgba(255,59,59,0.6), 0 0 0 rgba(255,59,59,0); transform: scale(1); }
    20% { text-shadow: 0 0 18px rgba(255,90,90,0.95), 0 0 30px rgba(255,40,40,0.8); transform: scale(1.03); }
    50% { text-shadow: 0 0 30px rgba(255,120,120,1), 0 0 50px rgba(255,60,60,0.95); transform: scale(1.06); }
    80% { text-shadow: 0 0 18px rgba(255,90,90,0.9), 0 0 30px rgba(255,40,40,0.7); transform: scale(1.02); }
    100% { text-shadow: 0 0 6px rgba(255,59,59,0.6); transform: scale(1); opacity:1; }
  }

  .moon-overlay {
    position: absolute;
    left: 50%;
    top: 10%;
    transform: translateX(-50%) translateY(-10%);
    pointer-events: none;
    z-index: 50;
    display:flex;
    align-items:center;
    justify-content:center;
    mix-blend-mode: screen;
  }

  @keyframes moonInOut {
    0% { opacity: 0; transform: translateX(-50%) translateY(-10%) scale(0.4) rotate(-8deg); filter: blur(2px); }
    12% { opacity: 1; transform: translateX(-50%) translateY(0%) scale(1.05) rotate(0deg); filter: blur(0px); }
    50% { opacity: 1; transform: translateX(-50%) translateY(0%) scale(1) rotate(0deg); filter: drop-shadow(0 0 22px rgba(255,200,60,0.12)); }
    85% { opacity: 0.9; transform: translateX(-50%) translateY(-6%) scale(1.08) rotate(2deg); filter: drop-shadow(0 0 36px rgba(255,100,100,0.12)); }
    100% { opacity: 0; transform: translateX(-50%) translateY(-20%) scale(0.5) rotate(4deg); filter: blur(3px); }
  }

  .moon-svg { width: 240px; height: 240px; transform-origin:center; }
  .moon-glow { filter: blur(6px) drop-shadow(0 0 28px rgba(255,80,80,0.45)); }

  @keyframes pulseText {
    0% { transform: scale(1) }
    40% { transform: scale(1.04) }
    60% { transform: scale(1.02) }
    100% { transform: scale(1) }
  }

  .activate-special .special-text {
    animation: intenseGlow 6s ease-in-out forwards, pulseText 1.4s infinite ease-in-out;
  }
  .activate-special .moon-overlay {
    animation: moonInOut 5.6s ease-in-out forwards;
  }
</style>

<div class="container">
  <h2> As Estrelas Revelam </h2>
  <div class="small" style="opacity:.85; margin-bottom:8px">Detector de Lua de Sangue.</div>

  <label>Era</label>
  <select id="era">
    <option>1ª Era</option>
    <option>2ª Era</option>
    <option>3ª Era</option>
    <option>4ª Era</option>
    <option>5ª Era</option>
  </select>

  <label>Ano</label>
  <input id="ano" type="number" placeholder="ex: 666">

  <label>Mês</label>
  <select id="mes">
    <option>Calanir</option>
    <option>Líranor</option>
    <option>Avalen</option>
    <option>Soleran</option>
    <option>Fendelis</option>
    <option>Ysiriel</option>
    <option>Ithilir</option>
    <option>Nelúmë</option>
  </select>

  <label>Dia (1–100)</label>
  <input id="dia" type="number" min="1" max="100">

  <label>Hora (0–23)</label>
  <input id="hora" type="number" min="0" max="23">

  <label>Minuto</label>
  <input id="min" type="number" min="1" max="59">

  <label>Segundo</label>
  <input id="seg" type="number" min="1" max="59">

  <button onclick="calcular()">CALCULAR</button>

  <div id="resultado"></div>
</div>

<script>
const eraLimits = {
  "1ª Era": 2630,
  "2ª Era": 10489,
  "3ª Era": 34702522,
  "4ª Era": 177,
  "5ª Era": 0
};

const elfMonths = ["Calanir","Líranor","Avalen","Soleran","Fendelis","Ysiriel","Ithilir","Nelúmë"];

const specialDates = [
  { era: "1ª Era", ano: 666, mes: "Calanir", dia: 73, hora: "03", min: "19", seg: "47" },
  { era: "2ª Era", ano: 4679, mes: "Ysiriel", dia: 12, hora: "03", min: "19", seg: "47" },
  { era: "3ª Era", ano: 5, mes: "Avalen", dia: 99, hora: "03", min: "19", seg: "47" },
  { era: "4ª Era", ano: 177, mes: "Fendelis", dia: 71, hora: "03", min: "19", seg: "47" }
];

function showSpecialEffect(container, messageText) {
  container.innerHTML = "";
  container.classList.add("activate-special");

  const t = document.createElement("div");
  t.className = "special-text";
  t.innerText = messageText;
  container.appendChild(t);

  const overlay = document.createElement("div");
  overlay.className = "moon-overlay";
  overlay.innerHTML = `
    <svg class="moon-svg moon-glow" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Lua">
      <defs>
        <radialGradient id="g" cx="40%" cy="35%">
          <stop offset="0%" stop-color="#ffd9a6"/>
          <stop offset="55%" stop-color="#ffb07a"/>
          <stop offset="100%" stop-color="#ff6b6b"/>
        </radialGradient>
        <filter id="grain">
          <feTurbulence baseFrequency="0.9" numOctaves="1" result="t"/>
          <feColorMatrix type="saturate" values="0" in="t" result="g"/>
          <feBlend in="SourceGraphic" in2="g" mode="overlay"/>
        </filter>
      </defs>

      <circle cx="100" cy="100" r="72" fill="url(#g)" opacity="0.98"/>
      <path d="M120 50 C140 70, 150 120, 110 140 C90 150, 70 150, 60 140 C40 120, 80 70, 100 60 Z" fill="#00000015"/>
      <g opacity="0.16" fill="#fff">
        <circle cx="70" cy="70" r="6" />
        <circle cx="130" cy="80" r="4" />
        <circle cx="95" cy="120" r="3" />
      </g>
    </svg>
  `;

  container.appendChild(overlay);

  setTimeout(() => {
    container.classList.remove("activate-special");
    t.style.transition = "opacity .6s ease-out, transform .6s ease-out";
    t.style.opacity = "0";
    t.style.transform = "scale(.98)";
    overlay.style.transition = "opacity .6s ease-out, transform .6s ease-out";
    overlay.style.opacity = "0";
    overlay.style.transform = "translateY(-10px) scale(.9)";
    setTimeout(() => { container.innerHTML = ""; }, 700);
  }, 5600);
}

function calcular() {
  const pg4 = document.getElementById("pg4");
  // query inputs inside pg4 to avoid ID conflicts with other pages
  const eraEl = pg4.querySelector("#era");
  const anoEl = pg4.querySelector("#ano");
  const mesEl = pg4.querySelector("#mes");
  const diaEl = pg4.querySelector("#dia");
  const horaEl = pg4.querySelector("#hora");
  const minEl = pg4.querySelector("#min");
  const segEl = pg4.querySelector("#seg");

  const era = eraEl ? eraEl.value : null;
  const ano = anoEl ? Number(anoEl.value) : NaN;
  const mes = mesEl ? mesEl.value : null;
  const dia = diaEl ? Number(diaEl.value) : NaN;
  const hora = horaEl ? Number(horaEl.value) : NaN;
  const min = minEl ? Number(minEl.value) : NaN;
  const seg = segEl ? Number(segEl.value) : NaN;

  const out = pg4.querySelector("#resultado");
  out.classList.remove("activate-special");
  out.innerHTML = "";

  if (!ano || ano < 1) return out.innerHTML = "<div class='err'>Ano inválido.</div>";
  if (era && ano > eraLimits[era]) return out.innerHTML = "<div class='err'>Essa era não durou/não vai durar tudo isso.</div>";
  if (isNaN(dia) || dia < 1 || dia > 100) return out.innerHTML = "<div class='err'>Dia inválido.</div>";
  if (isNaN(hora) || hora < 0 || hora > 23) return out.innerHTML = "<div class='err'>Hora inválida.</div>";
  if (isNaN(min) || min < 1 || min > 59) return out.innerHTML = "<div class='err'>Minuto inválido.</div>";
  if (isNaN(seg) || seg < 1 || seg > 59) return out.innerHTML = "<div class='err'>Segundo inválido.</div>";

  const horaS = String(hora).padStart(2,"0");
  const minS = String(min).padStart(2,"0");
  const segS = String(seg).padStart(2,"0");

  for (const s of specialDates) {
    if (s.era === era && s.ano === ano && s.mes === mes && s.dia === dia &&
        s.hora === horaS && s.min === minS && s.seg === segS) {

      const msgMap = {
        "1ª Era": "O PACTO",
        "2ª Era": "A INVASÃO",
        "3ª Era": "A QUEDA",
        "4ª Era": "UM NOVO COMEÇO"
      };

      return showSpecialEffect(out, msgMap[era]);
    }
  }

  out.innerHTML = "<div class='err'>Nenhuma Lua de Sangue detectada.</div>";
}
</script>

</div>

<!-- PAGE 5 -->
<div id="pg5" class="overlay" style="background-image:url('IMAGE5.png'); background-size:cover;">
  <h1>É IMPOSSÍVEL IMPEDIR A LUA DE SANGUE!</h1>
  <p>ELA DEVERÁ ACONTECER!<br>SE AS REGRAS NÃO FOREM CUMPRIDAS OS DANOS SERÃO MAIORES!</p>
</div>

</body>
</html>
